var sowb=window.sowb||{};jQuery((function(o){sowb.setupAccordion=function(){o(".sow-accordion").each((function(n,a){var e=o(this).closest(".so-widget-sow-accordion");if(e.data("initialized"))return o(this);var i=o(a).find("> .sow-accordion-panel");i.not(".sow-accordion-panel-open").find(".sow-accordion-panel-content").hide();var t=i.filter(".sow-accordion-panel-open").toArray(),c=function(){},r=function(n,a){var e=n.offset().top-90;a?o("body,html").animate({scrollTop:e},200):window.scrollTo(0,e)},s=function(n,a,e){var i=o(n);if(!i.is(".sow-accordion-panel-open")){i.find("> .sow-accordion-panel-content").slideDown({start:function(){o(window).trigger("resize"),o(sowb).trigger("setup_widgets")},complete:function(){e&&i.offset().top<window.scrollY&&r(i,!0),o(this).trigger("show")}}),i.find("> .sow-accordion-panel-header-container > .sow-accordion-panel-header").attr("aria-expanded",!0),i.addClass("sow-accordion-panel-open"),t.push(n);var d=o(n).parents(".sow-accordion-panel");d.length&&!d.hasClass("sow-accordion-panel-open")&&s(d.get(0),!0),a||c()}},d=function(n,a){var e=o(n);e.is(".sow-accordion-panel-open")&&(e.find("> .sow-accordion-panel-content").slideUp((function(){o(this).trigger("hide")})),e.find("> .sow-accordion-panel-header-container > .sow-accordion-panel-header").attr("aria-expanded",!1),e.removeClass("sow-accordion-panel-open"),t.splice(t.indexOf(n),1),a||c())};if(i.find("> .sow-accordion-panel-header-container > .sow-accordion-panel-header").on("click keydown",(function(n){if("keydown"==n.type){if(13!==n.keyCode&&32!==n.keyCode)return;n.preventDefault()}var a=o(this),i=e.data("maxOpenPanels"),c=a.closest(".sow-accordion-panel");if(c.is(".sow-accordion-panel-open")?d(c.get(0)):s(c.get(0),!1,!0),!isNaN(i)&&i>0&&t.length>i){var r=0;o.each(t.reverse(),(function(o,n){r!==i?r++:d(t[o])}))}})),e.data("useAnchorTags")){var l;c=function(){l&&clearTimeout(l),l=setTimeout((function(){for(var n=[],a=o(".sow-accordion-panel-open").toArray(),e=0;e<a.length;e++){var i=o(a[e]).data("anchor");if(i){var t=o(a[e]).parents(".sow-accordion-panel");(!t.length||t.length&&t.hasClass("sow-accordion-panel-open"))&&(n[e]=i)}}n&&n.length?window.location.hash=n.join(","):window.location.hash&&window.history.pushState("",document.title,window.location.pathname+window.location.search)}),100)};var w=function(){for(var n=i.toArray(),a=0;a<n.length;a++){var e=n[a],t=o(e).data("anchor");window.location.hash.substring(1).split(",").some((function(o){return decodeURI(t)===decodeURI(o)}))?s(e,!0):d(e,!0)}};o(window).on("hashchange",w),window.location.hash?w():c();var p=e.data("initialScrollPanel");if(window.location.hash&&t.length)setTimeout((function(){r(o(t[0]))}),500);else if(p>0){var h=p>i.length?i.last():i.eq(p-1);setTimeout((function(){r(h)}),500)}}e.data("initialized",!0)}))},sowb.setupAccordion(),o(sowb).on("setup_widgets",sowb.setupAccordion)})),window.sowb=sowb;