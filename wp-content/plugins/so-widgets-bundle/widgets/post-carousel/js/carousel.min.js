var sowb=window.sowb||{};jQuery((function(e){sowb.setupCarousel=function(){e(".sow-carousel-wrapper").each((function(){var t=e(this),s=t.closest(".sow-carousel-container"),a=t.closest(".sow-carousel-container").parent(),n=t.find(".sow-carousel-items"),o=t.find(".sow-carousel-item"),i=o.eq(0),r=0,l=1,c=!1,u=o.length,w=t.data("post-count"),d=t.data("loop-posts-enabled"),f=u===w,p=i.width()+parseInt(i.css("margin-right")),h=s.hasClass("js-rtl"),g=h?"margin-right":"margin-left",m=function(){const s=Math.ceil(t.outerWidth()/p),o=w-s+1,i=d&&!c&&f,h=null!==u&&!isNaN(u);if(r<0?r=i&&h?o:0:r>Math.min(u,o)&&(r=i?0:Math.min(u,o)),r+s>=u-1&&!c&&!f){c=!0,l++,n.append('<li class="sow-carousel-item sow-carousel-loading"></li>');var m=a.find('input[name="instance_hash"]').val();e.get(t.data("ajax-url"),{query:t.data("query"),action:"sow_carousel_load",paged:l,instance_hash:m},(function(s,a){e(s.html).appendTo(n).hide().fadeIn(),t.find(".sow-carousel-loading").remove(),u=t.find(".sow-carousel-item").length,f=u===w,c=!1}))}n.css("transition-duration","0.45s"),n.css(g,-p*r+"px")};if(a.on("click","a.sow-carousel-previous",(function(e){e.preventDefault(),r-=h?-1:1,m()})),a.on("click","a.sow-carousel-next",(function(e){e.preventDefault(),r+=h?-1:1,m()})),"function"==typeof t.swipe){var v,b=!1,D=0,M=0,I=0,T=0,x=h?"right":"left",_=function(e){return e<50&&e>-p*u&&(n.css("transition-duration","0s"),n.css(g,e+"px"),!0)},y=function(){var e=parseInt(n.css(g));r=Math.abs(Math.round(e/p)),m()};t.on("click",".sow-carousel-item a",(function(e){b&&(e.preventDefault(),b=!1)})),t.swipe({excludedElements:"",triggerOnTouchEnd:!0,threshold:75,swipeStatus:function(e,t,s,a,n,o,i){if("up"===s||"down"===s)return!1;if("start"===t)M=-p*r,T=(new Date).getTime(),clearInterval(v);else if("move"===t){s===x&&(a*=-1),_(M+a);var l=(new Date).getTime();I=(a-D)/((l-T)/1e3),T=l,D=a}else if("end"===t)if(b=!0,s===x&&(a*=-1),Math.abs(I)>400){I*=.1;var c=(new Date).getTime(),u=0;v=setInterval((function(){var e=((new Date).getTime()-c)/1e3,t=M+a+(u+=I*e),n=Math.abs(I)-30<0;s===x?I+=30:I-=30,!n&&_(t)||(clearInterval(v),y())}),20)}else y();else"cancel"===t&&m()}})}}))},sowb.setupCarousel(),e(sowb).on("setup_widgets",sowb.setupCarousel)})),window.sowb=sowb;